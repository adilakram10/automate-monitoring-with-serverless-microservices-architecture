 dev-operations terraform destroy
data.aws_ami.latest_amazon_linux: Reading...
aws_iam_policy.lambda_policy02: Refreshing state... [id=arn:aws:iam::992382468626:policy/lambda_policy02]
aws_iam_role.lambda_iam_role02: Refreshing state... [id=lambda_iam_role02]
aws_sns_topic.lambda_topic02: Refreshing state... [id=arn:aws:sns:us-east-2:992382468626:lambda_topic02]
aws_security_group.prodgroup02: Refreshing state... [id=sg-036a70fb52515f700]
data.aws_ami.latest_amazon_linux: Read complete after 1s [id=ami-0bfd6f7ee124e618c]
aws_instance.dev-instance02: Refreshing state... [id=i-0b680795dc65b4d7f]
aws_iam_role_policy_attachment.lambda_attach: Refreshing state... [id=lambda_iam_role02-20240704213643826700000002]
aws_lambda_function.lambda_function02: Refreshing state... [id=lambda_function02]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  - destroy

Terraform will perform the following actions:

  # aws_iam_policy.lambda_policy02 will be destroyed
  - resource "aws_iam_policy" "lambda_policy02" {
      - arn              = "arn:aws:iam::992382468626:policy/lambda_policy02" -> null
      - attachment_count = 1 -> null
      - description      = "Policy for Lambda function" -> null
      - id               = "arn:aws:iam::992382468626:policy/lambda_policy02" -> null
      - name             = "lambda_policy02" -> null
      - path             = "/" -> null
      - policy           = jsonencode(
            {
              - Statement = [
                  - {
                      - Action   = "ec2:StopInstances"
                      - Effect   = "Allow"
                      - Resource = "*"
                    },
                  - {
                      - Action   = "ec2:StartInstances"
                      - Effect   = "Allow"
                      - Resource = "*"
                    },
                  - {
                      - Action   = "sns:Publish"
                      - Effect   = "Allow"
                      - Resource = "arn:aws:sns:us-east-2:992382468626:lambda_topic02"
                    },
                  - {
                      - Action   = "logs:CreateLogGroup"
                      - Effect   = "Allow"
                      - Resource = "arn:aws:logs:us-east-2:*:*"
                    },
                  - {
                      - Action   = "logs:CreateLogStream"
                      - Effect   = "Allow"
                      - Resource = "arn:aws:logs:us-east-2:*:*"
                    },
                  - {
                      - Action   = "logs:PutLogEvents"
                      - Effect   = "Allow"
                      - Resource = "arn:aws:logs:us-east-2:*:*"
                    },
                ]
              - Version   = "2012-10-17"
            }
        ) -> null
      - policy_id        = "ANPA6ODU2YIJLDAQ7RTRF" -> null
      - tags             = {} -> null
      - tags_all         = {} -> null
        # (1 unchanged attribute hidden)
    }

  # aws_iam_role.lambda_iam_role02 will be destroyed
  - resource "aws_iam_role" "lambda_iam_role02" {
      - arn                   = "arn:aws:iam::992382468626:role/lambda_iam_role02" -> null
      - assume_role_policy    = jsonencode(
            {
              - Statement = [
                  - {
                      - Action    = "sts:AssumeRole"
                      - Effect    = "Allow"
                      - Principal = {
                          - Service = "lambda.amazonaws.com"
                        }
                    },
                ]
              - Version   = "2012-10-17"
            }
        ) -> null
      - create_date           = "2024-07-04T21:36:43Z" -> null
      - description           = "Execution role for Lambda function" -> null
      - force_detach_policies = false -> null
      - id                    = "lambda_iam_role02" -> null
      - managed_policy_arns   = [
          - "arn:aws:iam::992382468626:policy/lambda_policy02",
        ] -> null
      - max_session_duration  = 3600 -> null
      - name                  = "lambda_iam_role02" -> null
      - path                  = "/" -> null
      - tags                  = {} -> null
      - tags_all              = {} -> null
      - unique_id             = "AROA6ODU2YIJBPA4ZUC27" -> null
        # (2 unchanged attributes hidden)
    }

  # aws_iam_role_policy_attachment.lambda_attach will be destroyed
  - resource "aws_iam_role_policy_attachment" "lambda_attach" {
      - id         = "lambda_iam_role02-20240704213643826700000002" -> null
      - policy_arn = "arn:aws:iam::992382468626:policy/lambda_policy02" -> null
      - role       = "lambda_iam_role02" -> null
    }

  # aws_instance.dev-instance02 will be destroyed
  - resource "aws_instance" "dev-instance02" {
      - ami                                  = "ami-0bfd6f7ee124e618c" -> null
      - arn                                  = "arn:aws:ec2:us-east-2:992382468626:instance/i-0b680795dc65b4d7f" -> null
      - associate_public_ip_address          = true -> null
      - availability_zone                    = "us-east-2b" -> null
      - cpu_core_count                       = 1 -> null
      - cpu_threads_per_core                 = 1 -> null
      - disable_api_stop                     = false -> null
      - disable_api_termination              = false -> null
      - ebs_optimized                        = false -> null
      - get_password_data                    = false -> null
      - hibernation                          = false -> null
      - id                                   = "i-0b680795dc65b4d7f" -> null
      - instance_initiated_shutdown_behavior = "stop" -> null
      - instance_state                       = "running" -> null
      - instance_type                        = "t2.micro" -> null
      - ipv6_address_count                   = 0 -> null
      - ipv6_addresses                       = [] -> null
      - monitoring                           = false -> null
      - placement_partition_number           = 0 -> null
      - primary_network_interface_id         = "eni-02ad73e46178cb0b6" -> null
      - private_dns                          = "ip-172-31-22-185.us-east-2.compute.internal" -> null
      - private_ip                           = "172.31.22.185" -> null
      - public_dns                           = "ec2-3-135-65-245.us-east-2.compute.amazonaws.com" -> null
      - public_ip                            = "3.135.65.245" -> null
      - secondary_private_ips                = [] -> null
      - security_groups                      = [
          - "default",
        ] -> null
      - source_dest_check                    = true -> null
      - subnet_id                            = "subnet-03580bf9b89c097da" -> null
      - tags                                 = {
          - "Name" = "ExampleAppServerInstance"
        } -> null
      - tags_all                             = {
          - "Name" = "ExampleAppServerInstance"
        } -> null
      - tenancy                              = "default" -> null
      - user_data_replace_on_change          = false -> null
      - vpc_security_group_ids               = [
          - "sg-09f394bf1907174ed",
        ] -> null
        # (8 unchanged attributes hidden)

      - capacity_reservation_specification {
          - capacity_reservation_preference = "open" -> null
        }

      - cpu_options {
          - core_count       = 1 -> null
          - threads_per_core = 1 -> null
            # (1 unchanged attribute hidden)
        }

      - credit_specification {
          - cpu_credits = "standard" -> null
        }

      - enclave_options {
          - enabled = false -> null
        }

      - maintenance_options {
          - auto_recovery = "default" -> null
        }

      - metadata_options {
          - http_endpoint               = "enabled" -> null
          - http_protocol_ipv6          = "disabled" -> null
          - http_put_response_hop_limit = 1 -> null
          - http_tokens                 = "optional" -> null
          - instance_metadata_tags      = "disabled" -> null
        }

      - private_dns_name_options {
          - enable_resource_name_dns_a_record    = false -> null
          - enable_resource_name_dns_aaaa_record = false -> null
          - hostname_type                        = "ip-name" -> null
        }

      - root_block_device {
          - delete_on_termination = true -> null
          - device_name           = "/dev/xvda" -> null
          - encrypted             = false -> null
          - iops                  = 0 -> null
          - tags                  = {} -> null
          - tags_all              = {} -> null
          - throughput            = 0 -> null
          - volume_id             = "vol-0787a3ada9e86e3a0" -> null
          - volume_size           = 8 -> null
          - volume_type           = "standard" -> null
            # (1 unchanged attribute hidden)
        }
    }

  # aws_lambda_function.lambda_function02 will be destroyed
  - resource "aws_lambda_function" "lambda_function02" {
      - architectures                  = [
          - "x86_64",
        ] -> null
      - arn                            = "arn:aws:lambda:us-east-2:992382468626:function:lambda_function02" -> null
      - code_sha256                    = "Sz30FK1LQbwCDXY3T93RXOQJjsJ6ujPkbD/jkLZ/rSI=" -> null
      - filename                       = "/Users/admin/terraform/scripts/lambda_function.py.zip" -> null
      - function_name                  = "lambda_function02" -> null
      - handler                        = "index.lambda_handler" -> null
      - id                             = "lambda_function02" -> null
      - invoke_arn                     = "arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:992382468626:function:lambda_function02/invocations" -> null
      - last_modified                  = "2024-07-04T21:59:18.770+0000" -> null
      - layers                         = [] -> null
      - memory_size                    = 128 -> null
      - package_type                   = "Zip" -> null
      - publish                        = false -> null
      - qualified_arn                  = "arn:aws:lambda:us-east-2:992382468626:function:lambda_function02:$LATEST" -> null
      - qualified_invoke_arn           = "arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:992382468626:function:lambda_function02:$LATEST/invocations" -> null
      - reserved_concurrent_executions = -1 -> null
      - role                           = "arn:aws:iam::992382468626:role/lambda_iam_role02" -> null
      - runtime                        = "python3.9" -> null
      - skip_destroy                   = false -> null
      - source_code_size               = 560 -> null
      - tags                           = {} -> null
      - tags_all                       = {} -> null
      - timeout                        = 3 -> null
      - version                        = "$LATEST" -> null
        # (7 unchanged attributes hidden)

      - ephemeral_storage {
          - size = 512 -> null
        }

      - logging_config {
          - log_format            = "Text" -> null
          - log_group             = "/aws/lambda/lambda_function02" -> null
            # (2 unchanged attributes hidden)
        }

      - tracing_config {
          - mode = "PassThrough" -> null
        }
    }

  # aws_security_group.prodgroup02 will be destroyed
  - resource "aws_security_group" "prodgroup02" {
      - arn                    = "arn:aws:ec2:us-east-2:992382468626:security-group/sg-036a70fb52515f700" -> null
      - description            = "Security group for EC2 instance" -> null
      - egress                 = [] -> null
      - id                     = "sg-036a70fb52515f700" -> null
      - ingress                = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - from_port        = 22
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = []
              - self             = false
              - to_port          = 22
                # (1 unchanged attribute hidden)
            },
        ] -> null
      - name                   = "prodgroup02" -> null
      - owner_id               = "992382468626" -> null
      - revoke_rules_on_delete = false -> null
      - tags                   = {} -> null
      - tags_all               = {} -> null
      - vpc_id                 = "vpc-0ef9af2cb13984673" -> null
        # (1 unchanged attribute hidden)
    }

  # aws_sns_topic.lambda_topic02 will be destroyed
  - resource "aws_sns_topic" "lambda_topic02" {
      - application_success_feedback_sample_rate = 0 -> null
      - arn                                      = "arn:aws:sns:us-east-2:992382468626:lambda_topic02" -> null
      - content_based_deduplication              = false -> null
      - fifo_topic                               = false -> null
      - firehose_success_feedback_sample_rate    = 0 -> null
      - http_success_feedback_sample_rate        = 0 -> null
      - id                                       = "arn:aws:sns:us-east-2:992382468626:lambda_topic02" -> null
      - lambda_success_feedback_sample_rate      = 0 -> null
      - name                                     = "lambda_topic02" -> null
      - owner                                    = "992382468626" -> null
      - policy                                   = jsonencode(
            {
              - Id        = "__default_policy_ID"
              - Statement = [
                  - {
                      - Action    = [
                          - "SNS:GetTopicAttributes",
                          - "SNS:SetTopicAttributes",
                          - "SNS:AddPermission",
                          - "SNS:RemovePermission",
                          - "SNS:DeleteTopic",
                          - "SNS:Subscribe",
                          - "SNS:ListSubscriptionsByTopic",
                          - "SNS:Publish",
                        ]
                      - Condition = {
                          - StringEquals = {
                              - "AWS:SourceOwner" = "992382468626"
                            }
                        }
                      - Effect    = "Allow"
                      - Principal = {
                          - AWS = "*"
                        }
                      - Resource  = "arn:aws:sns:us-east-2:992382468626:lambda_topic02"
                      - Sid       = "__default_statement_ID"
                    },
                ]
              - Version   = "2008-10-17"
            }
        ) -> null
      - signature_version                        = 0 -> null
      - sqs_success_feedback_sample_rate         = 0 -> null
      - tags                                     = {} -> null
      - tags_all                                 = {} -> null
        # (17 unchanged attributes hidden)
    }

Plan: 0 to add, 0 to change, 7 to destroy.

Changes to Outputs:
  - instance_id        = "i-0b680795dc65b4d7f" -> null
  - instance_public_ip = "3.135.65.245" -> null

Do you really want to destroy all resources?
  Terraform will destroy all your managed infrastructure, as shown above.
  There is no undo. Only 'yes' will be accepted to confirm.

  Enter a value: yes

aws_iam_role_policy_attachment.lambda_attach: Destroying... [id=lambda_iam_role02-20240704213643826700000002]
aws_security_group.prodgroup02: Destroying... [id=sg-036a70fb52515f700]
aws_sns_topic.lambda_topic02: Destroying... [id=arn:aws:sns:us-east-2:992382468626:lambda_topic02]
aws_lambda_function.lambda_function02: Destroying... [id=lambda_function02]
aws_instance.dev-instance02: Destroying... [id=i-0b680795dc65b4d7f]
aws_lambda_function.lambda_function02: Destruction complete after 0s
aws_sns_topic.lambda_topic02: Destruction complete after 0s
aws_iam_role_policy_attachment.lambda_attach: Destruction complete after 0s
aws_iam_policy.lambda_policy02: Destroying... [id=arn:aws:iam::992382468626:policy/lambda_policy02]
aws_iam_role.lambda_iam_role02: Destroying... [id=lambda_iam_role02]
aws_iam_role.lambda_iam_role02: Destruction complete after 1s
aws_iam_policy.lambda_policy02: Destruction complete after 1s
aws_security_group.prodgroup02: Destruction complete after 1s
aws_instance.dev-instance02: Still destroying... [id=i-0b680795dc65b4d7f, 10s elapsed]
aws_instance.dev-instance02: Still destroying... [id=i-0b680795dc65b4d7f, 20s elapsed]
aws_instance.dev-instance02: Still destroying... [id=i-0b680795dc65b4d7f, 30s elapsed]
aws_instance.dev-instance02: Still destroying... [id=i-0b680795dc65b4d7f, 40s elapsed]
aws_instance.dev-instance02: Destruction complete after 41s

Destroy complete! Resources: 7 destroyed.
